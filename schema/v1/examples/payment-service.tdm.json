{
  "version": "1.0",
  "metadata": {
    "schema_version": "1.0",
    "scan_timestamp": "2026-02-21T10:00:00.000Z",
    "scanner_version": "0.1.0",
    "repository": "github.com/acme/payments-service",
    "languages_detected": ["python"],
    "total_dependencies_found": 8,
    "scan_duration_ms": 1240
  },
  "packages": [
    {
      "name": "stripe",
      "ecosystem": "pypi",
      "current_version": "7.0.0",
      "version_constraint": ">=7.0.0",
      "manifest_file": "requirements.txt",
      "locations": [{ "file": "requirements.txt", "line": 3 }],
      "usage_count": 1,
      "confidence": "high"
    },
    {
      "name": "requests",
      "ecosystem": "pypi",
      "current_version": "2.31.0",
      "version_constraint": ">=2.28.0",
      "manifest_file": "requirements.txt",
      "locations": [{ "file": "requirements.txt", "line": 5 }],
      "usage_count": 12,
      "confidence": "high"
    },
    {
      "name": "psycopg2-binary",
      "ecosystem": "pypi",
      "current_version": "2.9.9",
      "version_constraint": ">=2.9.0",
      "manifest_file": "requirements.txt",
      "locations": [{ "file": "requirements.txt", "line": 8 }],
      "usage_count": 3,
      "confidence": "high"
    },
    {
      "name": "boto3",
      "ecosystem": "pypi",
      "current_version": "1.34.0",
      "version_constraint": ">=1.30.0",
      "manifest_file": "requirements.txt",
      "locations": [{ "file": "requirements.txt", "line": 10 }],
      "usage_count": 5,
      "confidence": "high"
    }
  ],
  "apis": [
    {
      "url": "https://api.stripe.com/v1/charges",
      "method": "POST",
      "provider": "stripe",
      "locations": [
        {
          "file": "payments/stripe_client.py",
          "line": 42,
          "context": "stripe.Charge.create(amount=amount, currency='usd', source=token)",
          "usage": "method_call:stripe.Charge.create"
        }
      ],
      "usage_count": 1,
      "confidence": "high"
    },
    {
      "url": "https://api.stripe.com/v1/refunds",
      "method": "POST",
      "provider": "stripe",
      "locations": [
        {
          "file": "payments/stripe_client.py",
          "line": 78,
          "context": "stripe.Refund.create(charge=charge_id)",
          "usage": "method_call:stripe.Refund.create"
        }
      ],
      "usage_count": 1,
      "confidence": "high"
    },
    {
      "url": "https://hooks.slack.com/services/${SLACK_WEBHOOK_PATH}",
      "method": "POST",
      "provider": "slack",
      "locations": [
        {
          "file": "notifications/slack.py",
          "line": 15,
          "context": "requests.post(SLACK_WEBHOOK_URL, json=payload)",
          "usage": "http_call"
        }
      ],
      "usage_count": 4,
      "confidence": "medium"
    }
  ],
  "sdks": [
    {
      "provider": "stripe",
      "sdk_package": "stripe",
      "services_used": [],
      "api_methods": [
        "stripe.Charge.create",
        "stripe.Refund.create",
        "stripe.PaymentIntent.create",
        "stripe.Customer.create"
      ],
      "locations": [
        { "file": "payments/stripe_client.py", "line": 1, "usage": "import" }
      ],
      "usage_count": 12,
      "confidence": "high"
    },
    {
      "provider": "aws",
      "sdk_package": "boto3",
      "services_used": ["s3", "ses"],
      "api_methods": [
        "s3.put_object",
        "s3.get_object",
        "ses.send_email"
      ],
      "locations": [
        { "file": "storage/s3_client.py", "line": 1, "usage": "import" },
        { "file": "notifications/email.py", "line": 1, "usage": "import" }
      ],
      "usage_count": 8,
      "confidence": "high"
    }
  ],
  "infrastructure": [
    {
      "type": "postgresql",
      "connection_ref": "DATABASE_URL",
      "resolved_host": "db.acme.internal",
      "locations": [
        { "file": "db/connection.py", "line": 5, "context": "psycopg2.connect(os.environ['DATABASE_URL'])", "usage": "env_var" }
      ],
      "confidence": "high"
    },
    {
      "type": "redis",
      "connection_ref": "REDIS_URL",
      "resolved_host": null,
      "locations": [
        { "file": "cache/redis_client.py", "line": 3, "context": "redis.from_url(os.environ['REDIS_URL'])", "usage": "env_var" }
      ],
      "confidence": "high"
    }
  ],
  "webhooks": [
    {
      "direction": "outbound_registration",
      "target_url": "https://api.stripe.com/v1/webhook_endpoints",
      "provider": "stripe",
      "locations": [
        { "file": "webhooks/register.py", "line": 12, "context": "stripe.WebhookEndpoint.create(url=WEBHOOK_URL, ...)", "usage": "method_call" }
      ],
      "confidence": "medium"
    },
    {
      "direction": "inbound_callback",
      "target_url": "/webhooks/stripe",
      "provider": "stripe",
      "locations": [
        { "file": "webhooks/views.py", "line": 24, "context": "@app.route('/webhooks/stripe', methods=['POST'])", "usage": "route_handler" }
      ],
      "confidence": "high"
    }
  ]
}
